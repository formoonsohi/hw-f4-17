<!DOCTYPE html>
<html lang="uk">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pixabay Gallery - –í–∏–±—ñ—Ä —Ä–µ–¥–∞–∫—Ü—ñ—ó</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: Arial, sans-serif;
        background: #e8f5e9;
        padding: 20px;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
      }

      header {
        text-align: center;
        color: #2e7d32;
        margin-bottom: 30px;
      }

      h1 {
        font-size: 2em;
        margin-bottom: 10px;
      }

      .subtitle {
        font-size: 1em;
        color: #4caf50;
      }

      .api-notice {
        background: #fff9c4;
        border: 2px solid #fbc02d;
        padding: 15px;
        margin-bottom: 20px;
        text-align: center;
      }

      .api-notice strong {
        color: #f57c00;
      }

      .filters {
        background: white;
        padding: 15px;
        border: 2px solid #4caf50;
        margin-bottom: 20px;
      }

      .filters select {
        padding: 8px;
        border: 1px solid #4caf50;
        margin: 0 10px;
      }

      .stats {
        background: white;
        padding: 15px;
        border: 2px solid #4caf50;
        margin-bottom: 20px;
        text-align: center;
      }

      .gallery {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
      }

      .image-card {
        background: white;
        border: 2px solid #4caf50;
        cursor: pointer;
      }

      .image-wrapper {
        position: relative;
        padding-top: 75%;
        overflow: hidden;
        background: #f1f1f1;
      }

      .image-wrapper img {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        object-fit: cover;
      }

      .image-info {
        padding: 10px;
      }

      .image-tags {
        display: flex;
        flex-wrap: wrap;
        gap: 5px;
        margin-bottom: 10px;
      }

      .tag {
        background: #c8e6c9;
        padding: 3px 8px;
        font-size: 0.85em;
        color: #2e7d32;
      }

      .image-stats {
        display: flex;
        justify-content: space-between;
        font-size: 0.9em;
        color: #666;
      }

      .load-more-container {
        text-align: center;
        margin: 30px 0;
      }

      .load-more-btn {
        background: #4caf50;
        color: white;
        border: none;
        padding: 15px 30px;
        font-size: 1em;
        cursor: pointer;
      }

      .load-more-btn:hover:not(:disabled) {
        background: #388e3c;
      }

      .load-more-btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
      }

      .error {
        background: #ff5252;
        color: white;
        padding: 15px;
        margin: 20px 0;
        text-align: center;
      }

      .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.9);
        z-index: 1000;
      }

      .modal.active {
        display: flex;
        justify-content: center;
        align-items: center;
      }

      .modal-content {
        max-width: 90%;
        max-height: 90%;
        position: relative;
      }

      .modal-content img {
        max-width: 100%;
        max-height: 80vh;
      }

      .close-modal {
        position: absolute;
        top: -40px;
        right: 0;
        color: white;
        font-size: 30px;
        cursor: pointer;
        background: none;
        border: none;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <header>
        <h1>üñºÔ∏è –ì–∞–ª–µ—Ä–µ—è Pixabay</h1>
        <p class="subtitle">–í–∏–±—ñ—Ä —Ä–µ–¥–∞–∫—Ü—ñ—ó - –Ω–∞–π–∫—Ä–∞—â—ñ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è</p>
      </header>
      <div class="api-notice">
        <strong>‚ö†Ô∏è –í–ê–ñ–õ–ò–í–û:</strong> –í—Å—Ç–∞–≤—Ç–µ –≤–∞—à API –∫–ª—é—á —É –∫–æ–¥ (—Ä—è–¥–æ–∫ 210).
        –û—Ç—Ä–∏–º–∞—Ç–∏ –∫–ª—é—á:
        <a href="https://pixabay.com/api/docs/" target="_blank"
          >pixabay.com/api/docs/</a
        >
      </div>
      <div class="filters">
        <label>–¢–∏–ø –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è:</label>
        <select id="imageType">
          <option value="all">–í—Å—ñ —Ç–∏–ø–∏</option>
          <option value="photo">–§–æ—Ç–æ</option>
          <option value="illustration">–Ü–ª—é—Å—Ç—Ä–∞—Ü—ñ—ó</option>
          <option value="vector">–í–µ–∫—Ç–æ—Ä</option>
        </select>
        <label>–°–æ—Ä—Ç—É–≤–∞–Ω–Ω—è:</label>
        <select id="orderBy">
          <option value="popular">–ü–æ–ø—É–ª—è—Ä–Ω—ñ</option>
          <option value="latest">–ù–æ–≤—ñ—à—ñ</option>
        </select>
        <label>–ù–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ:</label>
        <select id="perPage">
          <option value="12">12</option>
          <option value="24">24</option>
          <option value="48">48</option>
        </select>
      </div>
      <div class="stats" id="stats"></div>
      <div class="gallery" id="gallery"></div>
      <div class="load-more-container">
        <button class="load-more-btn" id="loadMoreBtn">–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —â–µ</button>
      </div>
    </div>
    <div class="modal" id="modal">
      <div class="modal-content">
        <button class="close-modal" id="closeModal">√ó</button>
        <img id="modalImage" src="" alt="" />
      </div>
    </div>

    <script>
      // ========================================
      const API_KEY = "53713087-2b0a12a22f0eae895a449346a";
      // ========================================

      class PixabayGallery {
        constructor() {
          this.currentPage = 1;
          this.images = [];
          this.totalHits = 0;
          this.loading = false;
          this.init();
        }

        init() {
          if (API_KEY === "–í–ê–®_API_–ö–õ–Æ–ß_–°–Æ–î–ò") {
            this.showError(
              "‚ùå –ë—É–¥—å –ª–∞—Å–∫–∞, –≤—Å—Ç–∞–≤—Ç–µ –≤–∞—à API –∫–ª—é—á —É –∫–æ–¥ (—Ä—è–¥–æ–∫ 210)"
            );
            return;
          }
          this.loadImages();
          this.setupEventListeners();
        }

        setupEventListeners() {
          document
            .getElementById("loadMoreBtn")
            .addEventListener("click", () => this.loadMore());
          document
            .getElementById("imageType")
            .addEventListener("change", () => this.reset());
          document
            .getElementById("orderBy")
            .addEventListener("change", () => this.reset());
          document
            .getElementById("perPage")
            .addEventListener("change", () => this.reset());
          document
            .getElementById("modal")
            .addEventListener("click", () => this.closeModal());
          document
            .getElementById("closeModal")
            .addEventListener("click", () => this.closeModal());
          document
            .querySelector(".modal-content")
            .addEventListener("click", (e) => {
              e.stopPropagation();
            });
        }
        async loadImages() {
          if (this.loading) return;
          this.loading = true;
          const loadMoreBtn = document.getElementById("loadMoreBtn");
          loadMoreBtn.disabled = true;
          loadMoreBtn.textContent = "–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...";
          const imageType = document.getElementById("imageType").value;
          const orderBy = document.getElementById("orderBy").value;
          const perPage = document.getElementById("perPage").value;
          try {
            const params = new URLSearchParams({
              key: API_KEY,
              editors_choice: "true",
              page: this.currentPage,
              per_page: perPage,
              safesearch: "true",
            });
            if (imageType !== "all") {
              params.append("image_type", imageType);
            }
            params.append("order", orderBy);
            const url = `https://pixabay.com/api/?${params.toString()}`;
            const response = await fetch(url);
            if (!response.ok) {
              throw new Error(`HTTP –ø–æ–º–∏–ª–∫–∞! —Å—Ç–∞—Ç—É—Å: ${response.status}`);
            }
            const data = await response.json();
            if (data.hits && data.hits.length > 0) {
              this.images = [...this.images, ...data.hits];
              this.totalHits = data.totalHits;
              this.displayImages();
              this.updateStats();
            } else if (data.hits && data.hits.length === 0) {
              this.showError(
                "–ó–æ–±—Ä–∞–∂–µ–Ω–Ω—è –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ. –°–ø—Ä–æ–±—É–π—Ç–µ –∑–º—ñ–Ω–∏—Ç–∏ —Ñ—ñ–ª—å—Ç—Ä–∏."
              );
            } else {
              this.showError("–ù–µ–≤—ñ—Ä–Ω–∏–π API –∫–ª—é—á. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∫–ª—é—á —É –∫–æ–¥—ñ.");
            }
          } catch (error) {
            console.error("–ü–æ–º–∏–ª–∫–∞:", error);
            this.showError("–ü–æ–º–∏–ª–∫–∞: " + error.message);
          } finally {
            this.loading = false;
            loadMoreBtn.disabled = false;
            loadMoreBtn.textContent = "–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —â–µ";
          }
        }
        displayImages() {
          const gallery = document.getElementById("gallery");
          gallery.innerHTML = "";
          this.images.forEach((image) => {
            const card = this.createImageCard(image);
            gallery.appendChild(card);
          });
        }
        createImageCard(image) {
          const card = document.createElement("div");
          card.className = "image-card";
          card.addEventListener("click", () =>
            this.openModal(image.largeImageURL)
          );
          const tags = image.tags.split(",").slice(0, 3);
          const tagsHTML = tags
            .map((tag) => `<span class="tag">${tag.trim()}</span>`)
            .join("");
          card.innerHTML = `
                    <div class="image-wrapper">
                        <img src="${image.webformatURL}" alt="${image.tags}" loading="lazy">
                    </div>
                    <div class="image-info">
                        <div class="image-tags">${tagsHTML}</div>
                        <div class="image-stats">
                            <span>üëÅÔ∏è ${image.views}</span>
                            <span>‚ù§Ô∏è ${image.likes}</span>
                            <span>üí¨ ${image.comments}</span>
                        </div>
                    </div>
                `;
          return card;
        }
        updateStats() {
          const stats = document.getElementById("stats");
          const perPage = document.getElementById("perPage").value;
          const maxPages = Math.ceil(this.totalHits / perPage);
          stats.innerHTML = `
                    <strong>–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ:</strong> ${this.images.length} –∑ ${this.totalHits} –∑–æ–±—Ä–∞–∂–µ–Ω—å | 
                    <strong>–°—Ç–æ—Ä—ñ–Ω–∫–∞:</strong> ${this.currentPage} –∑ ${maxPages}
                `;
          const loadMoreBtn = document.getElementById("loadMoreBtn");
          if (this.images.length >= this.totalHits) {
            loadMoreBtn.style.display = "none";
          } else {
            loadMoreBtn.style.display = "inline-block";
          }
        }
        openModal(imageUrl) {
          const modal = document.getElementById("modal");
          const modalImage = document.getElementById("modalImage");
          modalImage.src = imageUrl;
          modal.classList.add("active");
        }
        closeModal() {
          const modal = document.getElementById("modal");
          modal.classList.remove("active");
        }
        showError(message) {
          const gallery = document.getElementById("gallery");
          gallery.innerHTML = `<div class="error">${message}</div>`;
        }
        loadMore() {
          this.currentPage++;
          this.loadImages();
        }
        reset() {
          this.currentPage = 1;
          this.images = [];
          this.loadImages();
        }
      }
      document.addEventListener("DOMContentLoaded", () => {
        new PixabayGallery();
      });
    </script>
  </body>
</html>
